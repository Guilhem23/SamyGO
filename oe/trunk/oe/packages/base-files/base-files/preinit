#!/bin/sh

export PATH=/bin:/sbin:/usr/bin:/usr/sbin

mount proc /proc -t proc
mount sysfs /sys -t sysfs
mount tmpfs /tmp -t tmpfs -o size=1024K
mount -n -t tmpfs -o mode=0755 udev /dev
mknod /dev/console c 5 1
mknod /dev/ptmx c 5 2
mknod /dev/null c 1 3
mknod /dev/urandom c 1 9
mkdir /dev/pts
mount -t devpts devpts /dev/pts
#mkdir /dev/sam
#mount -t tmpfs none /dev/sam -o size=1K,mode=1777
#mount -t tmpfs none /dtv -o size=10M,mode=1777

#dd if=/dev/console of=/dev/null bs=1 count=0 >/dev/null 2>/dev/null && {
#	M0=/dev/console
#	M1=/dev/console
#} else {
	M0=/dev/ptmx
	M1=/dev/ptmx
#}

exec <$M0 >$M1 2>&0

#ulimit -c 1024
#echo /dtv/core > /proc/sys/kernel/core_pattern
#echo "localhost" > /proc/sys/kernel/hostname
#echo "32" > /proc/sys/kernel/msgmni

#ifconfig lo 127.0.0.1
#udhcpc

exec /sbin/init
