#!/bin/sh
#
# Â© Copyright 1996-2010, ZsoltTech.Com
#       by Ser Lev Arris <arris@ZsoltTech.Com>
#
#       donated for the SamyGo Project
#       http://samygo.sourceforge.net/
#
#       Version: SamyGO svn $Id$

. /dtv/SGO.env

case $1 in 
	start)
	# we really need the stuff for external firmware
	insmod $MOD_DIR/kernel/drivers/base/firmware_class.ko

	# copy/link firmware directory so mdev find it
	ln -sf $SYSROOT/firmware /dtv/firmware

	# copy config file
	cp -f $DISTROOT/mdev.conf /mtd_rwarea/

	# just for custom rootfs at boot time 
	# mount -t tmpfs -o size=64k,mode=0755 tmpfs /dev
	# mkdir /dev/pts
	# mount -t devpts devpts /dev/pts
	echo $DISTROOT/usr/sbin/mdev > /proc/sys/kernel/hotplug
	# mdev -s
	;;
	stop)
	echo /sbin/hotplug > /proc/sys/kernel/hotplug
	;;
	status)
	cat /proc/sys/kernel/hotplug
	;;
	*)
	echo "Usage: $0 {start|stop|status}" 1>&2
	exit 0
	;;
esac
